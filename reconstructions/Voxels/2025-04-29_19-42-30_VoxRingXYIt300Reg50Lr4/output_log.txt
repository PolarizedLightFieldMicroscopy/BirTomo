
Initializing a Reconstructor, using computing device cpu
Omitting rays based on pixels with zero retardance.
For raytracing, using computing device cpu
Raytracing time in seconds: 0.09
Preparing rays for all rays at once...
Prepared geometry for all rays at once.
No radiometry provided for filtering rays.
Saving rays...
Rays saved in 0 seconds to ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/config_parameters/rays.pkl
Setting up the voxel mask...
Identifying the voxels that are reached by the rays out of the 3757 voxels.
Number of voxels reached by the rays: 3,241
	Included in nonzero retardance pixels: 2,437
	Included in zero retardance pixels: 3,221
		For 2 or more rays: 3,137
Masking out voxels except for 28 voxels. First, at most, 20 voxels are tensor([1162, 1166, 1258, 1274, 1326, 1342, 1434, 1438, 1793, 1827, 1842, 1843,
        1845, 1846, 1859, 1863, 1873, 1875, 1881, 1883], dtype=torch.int32)
Voxel mask created in 0.09 seconds
Using retardance and azimuth images for data-fidelity term.
Reconstructor initialized in 0.22 seconds

Deleting unnecessary attributes to save memory...
	Deleted nonzero pixels dict
	Deleted ray valid indices by ray num
	Deleted mask from rays class
	Deleted radiometry
	Deleted volume initial guess
Beginning reconstruction...
Setting up optimizer and scheduler...
Using optimizer: Nadam
Using optimizer: Nadam
Starting iterations...
Learning rates changed at iteration 36:
Iteration 35: 1.00e-01, 1.00e-04 -> Iteration 36: 1.00e-01, 8.00e-05
Learning rates changed at iteration 41:
Iteration 40: 1.00e-01, 8.00e-05 -> Iteration 41: 8.00e-02, 8.00e-05
Learning rates changed at iteration 42:
Iteration 41: 8.00e-02, 8.00e-05 -> Iteration 42: 8.00e-02, 6.40e-05
Learning rates changed at iteration 48:
Iteration 47: 8.00e-02, 6.40e-05 -> Iteration 48: 8.00e-02, 5.12e-05
Learning rates changed at iteration 52:
Iteration 51: 8.00e-02, 5.12e-05 -> Iteration 52: 6.40e-02, 5.12e-05
Learning rates changed at iteration 54:
Iteration 53: 6.40e-02, 5.12e-05 -> Iteration 54: 6.40e-02, 4.10e-05
Learning rates changed at iteration 60:
Iteration 59: 6.40e-02, 4.10e-05 -> Iteration 60: 6.40e-02, 3.28e-05
Learning rates changed at iteration 63:
Iteration 62: 6.40e-02, 3.28e-05 -> Iteration 63: 5.12e-02, 3.28e-05
Learning rates changed at iteration 66:
Iteration 65: 5.12e-02, 3.28e-05 -> Iteration 66: 5.12e-02, 2.62e-05
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/results_in_progress/volume_iter_0100.h5
Learning rates changed at iteration 129:
Iteration 128: 5.12e-02, 2.62e-05 -> Iteration 129: 5.12e-02, 2.10e-05
Learning rates changed at iteration 134:
Iteration 133: 5.12e-02, 2.10e-05 -> Iteration 134: 4.10e-02, 2.10e-05
Learning rates changed at iteration 171:
Iteration 170: 4.10e-02, 2.10e-05 -> Iteration 171: 4.10e-02, 1.68e-05
Learning rates changed at iteration 176:
Iteration 175: 4.10e-02, 1.68e-05 -> Iteration 176: 3.28e-02, 1.68e-05
Learning rates changed at iteration 177:
Iteration 176: 3.28e-02, 1.68e-05 -> Iteration 177: 3.28e-02, 1.34e-05
Learning rates changed at iteration 183:
Iteration 182: 3.28e-02, 1.34e-05 -> Iteration 183: 3.28e-02, 1.07e-05
Learning rates changed at iteration 187:
Iteration 186: 3.28e-02, 1.07e-05 -> Iteration 187: 2.62e-02, 1.07e-05
Learning rates changed at iteration 189:
Iteration 188: 2.62e-02, 1.07e-05 -> Iteration 189: 2.62e-02, 8.59e-06
Learning rates changed at iteration 195:
Iteration 194: 2.62e-02, 8.59e-06 -> Iteration 195: 2.62e-02, 6.87e-06
Learning rates changed at iteration 198:
Iteration 197: 2.62e-02, 6.87e-06 -> Iteration 198: 2.10e-02, 6.87e-06
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/results_in_progress/volume_iter_0200.h5
Learning rates changed at iteration 201:
Iteration 200: 2.10e-02, 6.87e-06 -> Iteration 201: 2.10e-02, 5.50e-06
Learning rates changed at iteration 207:
Iteration 206: 2.10e-02, 5.50e-06 -> Iteration 207: 2.10e-02, 4.40e-06
Learning rates changed at iteration 209:
Iteration 208: 2.10e-02, 4.40e-06 -> Iteration 209: 1.68e-02, 4.40e-06
Learning rates changed at iteration 213:
Iteration 212: 1.68e-02, 4.40e-06 -> Iteration 213: 1.68e-02, 3.52e-06
Learning rates changed at iteration 219:
Iteration 218: 1.68e-02, 3.52e-06 -> Iteration 219: 1.68e-02, 2.81e-06
Learning rates changed at iteration 220:
Iteration 219: 1.68e-02, 2.81e-06 -> Iteration 220: 1.34e-02, 2.81e-06
Learning rates changed at iteration 225:
Iteration 224: 1.34e-02, 2.81e-06 -> Iteration 225: 1.34e-02, 2.25e-06
Learning rates changed at iteration 231:
Iteration 230: 1.34e-02, 2.25e-06 -> Iteration 231: 1.07e-02, 1.80e-06
Learning rates changed at iteration 237:
Iteration 236: 1.07e-02, 1.80e-06 -> Iteration 237: 1.07e-02, 1.44e-06
Learning rates changed at iteration 242:
Iteration 241: 1.07e-02, 1.44e-06 -> Iteration 242: 8.59e-03, 1.44e-06
Learning rates changed at iteration 243:
Iteration 242: 8.59e-03, 1.44e-06 -> Iteration 243: 8.59e-03, 1.15e-06
Learning rates changed at iteration 249:
Iteration 248: 8.59e-03, 1.15e-06 -> Iteration 249: 8.59e-03, 9.22e-07
Learning rates changed at iteration 253:
Iteration 252: 8.59e-03, 9.22e-07 -> Iteration 253: 6.87e-03, 9.22e-07
Learning rates changed at iteration 255:
Iteration 254: 6.87e-03, 9.22e-07 -> Iteration 255: 6.87e-03, 7.38e-07
Learning rates changed at iteration 261:
Iteration 260: 6.87e-03, 7.38e-07 -> Iteration 261: 6.87e-03, 5.90e-07
Learning rates changed at iteration 264:
Iteration 263: 6.87e-03, 5.90e-07 -> Iteration 264: 5.50e-03, 5.90e-07
Learning rates changed at iteration 267:
Iteration 266: 5.50e-03, 5.90e-07 -> Iteration 267: 5.50e-03, 4.72e-07
Learning rates changed at iteration 273:
Iteration 272: 5.50e-03, 4.72e-07 -> Iteration 273: 5.50e-03, 3.78e-07
Learning rates changed at iteration 275:
Iteration 274: 5.50e-03, 3.78e-07 -> Iteration 275: 4.40e-03, 3.78e-07
Learning rates changed at iteration 279:
Iteration 278: 4.40e-03, 3.78e-07 -> Iteration 279: 4.40e-03, 3.02e-07
Learning rates changed at iteration 285:
Iteration 284: 4.40e-03, 3.02e-07 -> Iteration 285: 4.40e-03, 2.42e-07
Learning rates changed at iteration 286:
Iteration 285: 4.40e-03, 2.42e-07 -> Iteration 286: 3.52e-03, 2.42e-07
Learning rates changed at iteration 291:
Iteration 290: 3.52e-03, 2.42e-07 -> Iteration 291: 3.52e-03, 1.93e-07
Learning rates changed at iteration 297:
Iteration 296: 3.52e-03, 1.93e-07 -> Iteration 297: 2.81e-03, 1.55e-07
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/results_in_progress/volume_iter_0300.h5
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/volume.h5
Saved the final volume estimation to ../reconstructions/Voxels/2025-04-29_19-42-30_VoxRingXYIt300Reg50Lr4/volume.h5
