
Initializing a Reconstructor, using computing device cuda
Omitting rays based on pixels with zero retardance.
For raytracing, using computing device cuda
Raytracing time in seconds: 0.17
Preparing rays for all rays at once...
Prepared geometry for all rays at once.
No radiometry provided for filtering rays.
Saving rays...
Rays saved in 0 seconds to ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\config_parameters\rays.pkl
Setting up the voxel mask...
Identifying the voxels that are reached by the rays out of the 3757 voxels.
Number of voxels reached by the rays: 3,241
	Included in nonzero retardance pixels: 2,819
	Included in zero retardance pixels: 3,219
		For 2 or more rays: 3,138
Masking out voxels except for 40 voxels. First, at most, 20 voxels are tensor([1160, 1168, 1224, 1240, 1241, 1257, 1258, 1274, 1299, 1301, 1302, 1326,
        1342, 1343, 1359, 1360, 1376, 1432, 1440, 1587], dtype=torch.int32)
Voxel mask created in 0.35 seconds
Using retardance and azimuth images for data-fidelity term.
Reconstructor initialized in 0.59 seconds

Deleting unnecessary attributes to save memory...
	Deleted nonzero pixels dict
	Deleted ray valid indices by ray num
	Deleted mask from rays class
	Deleted radiometry
	Deleted volume initial guess
Beginning reconstruction...
Setting up optimizer and scheduler...
Using optimizer: Nadam
Using optimizer: Nadam
Starting iterations...
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0050.h5
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0100.h5
Learning rates changed at iteration 118:
Iteration 117: 1.00e-01, 1.00e-04 -> Iteration 118: 1.00e-01, 8.00e-05
Learning rates changed at iteration 123:
Iteration 122: 1.00e-01, 8.00e-05 -> Iteration 123: 8.00e-02, 8.00e-05
Learning rates changed at iteration 124:
Iteration 123: 8.00e-02, 8.00e-05 -> Iteration 124: 8.00e-02, 6.40e-05
Learning rates changed at iteration 130:
Iteration 129: 8.00e-02, 6.40e-05 -> Iteration 130: 8.00e-02, 5.12e-05
Learning rates changed at iteration 134:
Iteration 133: 8.00e-02, 5.12e-05 -> Iteration 134: 6.40e-02, 5.12e-05
Learning rates changed at iteration 136:
Iteration 135: 6.40e-02, 5.12e-05 -> Iteration 136: 6.40e-02, 4.10e-05
Learning rates changed at iteration 142:
Iteration 141: 6.40e-02, 4.10e-05 -> Iteration 142: 6.40e-02, 3.28e-05
Learning rates changed at iteration 145:
Iteration 144: 6.40e-02, 3.28e-05 -> Iteration 145: 5.12e-02, 3.28e-05
Learning rates changed at iteration 148:
Iteration 147: 5.12e-02, 3.28e-05 -> Iteration 148: 5.12e-02, 2.62e-05
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0150.h5
Learning rates changed at iteration 154:
Iteration 153: 5.12e-02, 2.62e-05 -> Iteration 154: 5.12e-02, 2.10e-05
Learning rates changed at iteration 156:
Iteration 155: 5.12e-02, 2.10e-05 -> Iteration 156: 4.10e-02, 2.10e-05
Learning rates changed at iteration 160:
Iteration 159: 4.10e-02, 2.10e-05 -> Iteration 160: 4.10e-02, 1.68e-05
Learning rates changed at iteration 166:
Iteration 165: 4.10e-02, 1.68e-05 -> Iteration 166: 4.10e-02, 1.34e-05
Learning rates changed at iteration 167:
Iteration 166: 4.10e-02, 1.34e-05 -> Iteration 167: 3.28e-02, 1.34e-05
Learning rates changed at iteration 172:
Iteration 171: 3.28e-02, 1.34e-05 -> Iteration 172: 3.28e-02, 1.07e-05
Learning rates changed at iteration 178:
Iteration 177: 3.28e-02, 1.07e-05 -> Iteration 178: 2.62e-02, 8.59e-06
Learning rates changed at iteration 184:
Iteration 183: 2.62e-02, 8.59e-06 -> Iteration 184: 2.62e-02, 6.87e-06
Learning rates changed at iteration 189:
Iteration 188: 2.62e-02, 6.87e-06 -> Iteration 189: 2.10e-02, 6.87e-06
Learning rates changed at iteration 190:
Iteration 189: 2.10e-02, 6.87e-06 -> Iteration 190: 2.10e-02, 5.50e-06
Learning rates changed at iteration 196:
Iteration 195: 2.10e-02, 5.50e-06 -> Iteration 196: 2.10e-02, 4.40e-06
Learning rates changed at iteration 200:
Iteration 199: 2.10e-02, 4.40e-06 -> Iteration 200: 1.68e-02, 4.40e-06
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0200.h5
Learning rates changed at iteration 202:
Iteration 201: 1.68e-02, 4.40e-06 -> Iteration 202: 1.68e-02, 3.52e-06
Learning rates changed at iteration 208:
Iteration 207: 1.68e-02, 3.52e-06 -> Iteration 208: 1.68e-02, 2.81e-06
Learning rates changed at iteration 211:
Iteration 210: 1.68e-02, 2.81e-06 -> Iteration 211: 1.34e-02, 2.81e-06
Learning rates changed at iteration 214:
Iteration 213: 1.34e-02, 2.81e-06 -> Iteration 214: 1.34e-02, 2.25e-06
Learning rates changed at iteration 220:
Iteration 219: 1.34e-02, 2.25e-06 -> Iteration 220: 1.34e-02, 1.80e-06
Learning rates changed at iteration 222:
Iteration 221: 1.34e-02, 1.80e-06 -> Iteration 222: 1.07e-02, 1.80e-06
Learning rates changed at iteration 226:
Iteration 225: 1.07e-02, 1.80e-06 -> Iteration 226: 1.07e-02, 1.44e-06
Learning rates changed at iteration 232:
Iteration 231: 1.07e-02, 1.44e-06 -> Iteration 232: 1.07e-02, 1.15e-06
Learning rates changed at iteration 233:
Iteration 232: 1.07e-02, 1.15e-06 -> Iteration 233: 8.59e-03, 1.15e-06
Learning rates changed at iteration 238:
Iteration 237: 8.59e-03, 1.15e-06 -> Iteration 238: 8.59e-03, 9.22e-07
Learning rates changed at iteration 244:
Iteration 243: 8.59e-03, 9.22e-07 -> Iteration 244: 6.87e-03, 7.38e-07
Learning rates changed at iteration 250:
Iteration 249: 6.87e-03, 7.38e-07 -> Iteration 250: 6.87e-03, 5.90e-07
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0250.h5
Learning rates changed at iteration 255:
Iteration 254: 6.87e-03, 5.90e-07 -> Iteration 255: 5.50e-03, 5.90e-07
Learning rates changed at iteration 256:
Iteration 255: 5.50e-03, 5.90e-07 -> Iteration 256: 5.50e-03, 4.72e-07
Learning rates changed at iteration 262:
Iteration 261: 5.50e-03, 4.72e-07 -> Iteration 262: 5.50e-03, 3.78e-07
Learning rates changed at iteration 266:
Iteration 265: 5.50e-03, 3.78e-07 -> Iteration 266: 4.40e-03, 3.78e-07
Learning rates changed at iteration 268:
Iteration 267: 4.40e-03, 3.78e-07 -> Iteration 268: 4.40e-03, 3.02e-07
Learning rates changed at iteration 274:
Iteration 273: 4.40e-03, 3.02e-07 -> Iteration 274: 4.40e-03, 2.42e-07
Learning rates changed at iteration 277:
Iteration 276: 4.40e-03, 2.42e-07 -> Iteration 277: 3.52e-03, 2.42e-07
Learning rates changed at iteration 280:
Iteration 279: 3.52e-03, 2.42e-07 -> Iteration 280: 3.52e-03, 1.93e-07
Learning rates changed at iteration 286:
Iteration 285: 3.52e-03, 1.93e-07 -> Iteration 286: 3.52e-03, 1.55e-07
Learning rates changed at iteration 288:
Iteration 287: 3.52e-03, 1.55e-07 -> Iteration 288: 2.81e-03, 1.55e-07
Learning rates changed at iteration 292:
Iteration 291: 2.81e-03, 1.55e-07 -> Iteration 292: 2.81e-03, 1.24e-07
Learning rates changed at iteration 298:
Iteration 297: 2.81e-03, 1.24e-07 -> Iteration 298: 2.81e-03, 9.90e-08
Learning rates changed at iteration 299:
Iteration 298: 2.81e-03, 9.90e-08 -> Iteration 299: 2.25e-03, 9.90e-08
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\results_in_progress\volume_iter_0300.h5
Saving volume to h5 file: ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\volume.h5
Saved the final volume estimation to ..\reconstructions\Voxels\2025-04-29_14-30-17_VoxRingXZ300Reg100\volume.h5
