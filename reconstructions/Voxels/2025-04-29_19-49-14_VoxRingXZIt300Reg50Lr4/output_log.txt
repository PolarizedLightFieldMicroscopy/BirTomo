
Initializing a Reconstructor, using computing device cpu
Omitting rays based on pixels with zero retardance.
For raytracing, using computing device cpu
Raytracing time in seconds: 0.07
Preparing rays for all rays at once...
Prepared geometry for all rays at once.
No radiometry provided for filtering rays.
Saving rays...
Rays saved in 0 seconds to ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/config_parameters/rays.pkl
Setting up the voxel mask...
Identifying the voxels that are reached by the rays out of the 3757 voxels.
Number of voxels reached by the rays: 3,241
	Included in nonzero retardance pixels: 2,817
	Included in zero retardance pixels: 3,217
		For 2 or more rays: 3,141
Masking out voxels except for 38 voxels. First, at most, 20 voxels are tensor([1160, 1168, 1224, 1240, 1241, 1257, 1258, 1274, 1299, 1302, 1326, 1342,
        1343, 1359, 1360, 1376, 1432, 1440, 1587, 1591], dtype=torch.int32)
Voxel mask created in 0.12 seconds
Using retardance and azimuth images for data-fidelity term.
Reconstructor initialized in 0.22 seconds

Deleting unnecessary attributes to save memory...
	Deleted nonzero pixels dict
	Deleted ray valid indices by ray num
	Deleted mask from rays class
	Deleted radiometry
	Deleted volume initial guess
Beginning reconstruction...
Setting up optimizer and scheduler...
Using optimizer: Nadam
Using optimizer: Nadam
Starting iterations...
Learning rates changed at iteration 100:
Iteration 99: 1.00e-01, 1.00e-04 -> Iteration 100: 1.00e-01, 8.00e-05
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/results_in_progress/volume_iter_0100.h5
Learning rates changed at iteration 105:
Iteration 104: 1.00e-01, 8.00e-05 -> Iteration 105: 8.00e-02, 8.00e-05
Learning rates changed at iteration 106:
Iteration 105: 8.00e-02, 8.00e-05 -> Iteration 106: 8.00e-02, 6.40e-05
Learning rates changed at iteration 112:
Iteration 111: 8.00e-02, 6.40e-05 -> Iteration 112: 8.00e-02, 5.12e-05
Learning rates changed at iteration 116:
Iteration 115: 8.00e-02, 5.12e-05 -> Iteration 116: 6.40e-02, 5.12e-05
Learning rates changed at iteration 118:
Iteration 117: 6.40e-02, 5.12e-05 -> Iteration 118: 6.40e-02, 4.10e-05
Learning rates changed at iteration 124:
Iteration 123: 6.40e-02, 4.10e-05 -> Iteration 124: 6.40e-02, 3.28e-05
Learning rates changed at iteration 127:
Iteration 126: 6.40e-02, 3.28e-05 -> Iteration 127: 5.12e-02, 3.28e-05
Learning rates changed at iteration 130:
Iteration 129: 5.12e-02, 3.28e-05 -> Iteration 130: 5.12e-02, 2.62e-05
Learning rates changed at iteration 136:
Iteration 135: 5.12e-02, 2.62e-05 -> Iteration 136: 5.12e-02, 2.10e-05
Learning rates changed at iteration 138:
Iteration 137: 5.12e-02, 2.10e-05 -> Iteration 138: 4.10e-02, 2.10e-05
Learning rates changed at iteration 142:
Iteration 141: 4.10e-02, 2.10e-05 -> Iteration 142: 4.10e-02, 1.68e-05
Learning rates changed at iteration 148:
Iteration 147: 4.10e-02, 1.68e-05 -> Iteration 148: 4.10e-02, 1.34e-05
Learning rates changed at iteration 149:
Iteration 148: 4.10e-02, 1.34e-05 -> Iteration 149: 3.28e-02, 1.34e-05
Learning rates changed at iteration 154:
Iteration 153: 3.28e-02, 1.34e-05 -> Iteration 154: 3.28e-02, 1.07e-05
Learning rates changed at iteration 160:
Iteration 159: 3.28e-02, 1.07e-05 -> Iteration 160: 2.62e-02, 8.59e-06
Learning rates changed at iteration 166:
Iteration 165: 2.62e-02, 8.59e-06 -> Iteration 166: 2.62e-02, 6.87e-06
Learning rates changed at iteration 171:
Iteration 170: 2.62e-02, 6.87e-06 -> Iteration 171: 2.10e-02, 6.87e-06
Learning rates changed at iteration 172:
Iteration 171: 2.10e-02, 6.87e-06 -> Iteration 172: 2.10e-02, 5.50e-06
Learning rates changed at iteration 178:
Iteration 177: 2.10e-02, 5.50e-06 -> Iteration 178: 2.10e-02, 4.40e-06
Learning rates changed at iteration 182:
Iteration 181: 2.10e-02, 4.40e-06 -> Iteration 182: 1.68e-02, 4.40e-06
Learning rates changed at iteration 184:
Iteration 183: 1.68e-02, 4.40e-06 -> Iteration 184: 1.68e-02, 3.52e-06
Learning rates changed at iteration 190:
Iteration 189: 1.68e-02, 3.52e-06 -> Iteration 190: 1.68e-02, 2.81e-06
Learning rates changed at iteration 193:
Iteration 192: 1.68e-02, 2.81e-06 -> Iteration 193: 1.34e-02, 2.81e-06
Learning rates changed at iteration 196:
Iteration 195: 1.34e-02, 2.81e-06 -> Iteration 196: 1.34e-02, 2.25e-06
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/results_in_progress/volume_iter_0200.h5
Learning rates changed at iteration 202:
Iteration 201: 1.34e-02, 2.25e-06 -> Iteration 202: 1.34e-02, 1.80e-06
Learning rates changed at iteration 204:
Iteration 203: 1.34e-02, 1.80e-06 -> Iteration 204: 1.07e-02, 1.80e-06
Learning rates changed at iteration 208:
Iteration 207: 1.07e-02, 1.80e-06 -> Iteration 208: 1.07e-02, 1.44e-06
Learning rates changed at iteration 214:
Iteration 213: 1.07e-02, 1.44e-06 -> Iteration 214: 1.07e-02, 1.15e-06
Learning rates changed at iteration 215:
Iteration 214: 1.07e-02, 1.15e-06 -> Iteration 215: 8.59e-03, 1.15e-06
Learning rates changed at iteration 220:
Iteration 219: 8.59e-03, 1.15e-06 -> Iteration 220: 8.59e-03, 9.22e-07
Learning rates changed at iteration 226:
Iteration 225: 8.59e-03, 9.22e-07 -> Iteration 226: 6.87e-03, 7.38e-07
Learning rates changed at iteration 232:
Iteration 231: 6.87e-03, 7.38e-07 -> Iteration 232: 6.87e-03, 5.90e-07
Learning rates changed at iteration 237:
Iteration 236: 6.87e-03, 5.90e-07 -> Iteration 237: 5.50e-03, 5.90e-07
Learning rates changed at iteration 238:
Iteration 237: 5.50e-03, 5.90e-07 -> Iteration 238: 5.50e-03, 4.72e-07
Learning rates changed at iteration 244:
Iteration 243: 5.50e-03, 4.72e-07 -> Iteration 244: 5.50e-03, 3.78e-07
Learning rates changed at iteration 248:
Iteration 247: 5.50e-03, 3.78e-07 -> Iteration 248: 4.40e-03, 3.78e-07
Learning rates changed at iteration 250:
Iteration 249: 4.40e-03, 3.78e-07 -> Iteration 250: 4.40e-03, 3.02e-07
Learning rates changed at iteration 256:
Iteration 255: 4.40e-03, 3.02e-07 -> Iteration 256: 4.40e-03, 2.42e-07
Learning rates changed at iteration 259:
Iteration 258: 4.40e-03, 2.42e-07 -> Iteration 259: 3.52e-03, 2.42e-07
Learning rates changed at iteration 262:
Iteration 261: 3.52e-03, 2.42e-07 -> Iteration 262: 3.52e-03, 1.93e-07
Learning rates changed at iteration 268:
Iteration 267: 3.52e-03, 1.93e-07 -> Iteration 268: 3.52e-03, 1.55e-07
Learning rates changed at iteration 270:
Iteration 269: 3.52e-03, 1.55e-07 -> Iteration 270: 2.81e-03, 1.55e-07
Learning rates changed at iteration 274:
Iteration 273: 2.81e-03, 1.55e-07 -> Iteration 274: 2.81e-03, 1.24e-07
Learning rates changed at iteration 280:
Iteration 279: 2.81e-03, 1.24e-07 -> Iteration 280: 2.81e-03, 9.90e-08
Learning rates changed at iteration 281:
Iteration 280: 2.81e-03, 9.90e-08 -> Iteration 281: 2.25e-03, 9.90e-08
Learning rates changed at iteration 286:
Iteration 285: 2.25e-03, 9.90e-08 -> Iteration 286: 2.25e-03, 7.92e-08
Learning rates changed at iteration 292:
Iteration 291: 2.25e-03, 7.92e-08 -> Iteration 292: 1.80e-03, 6.34e-08
Learning rates changed at iteration 298:
Iteration 297: 1.80e-03, 6.34e-08 -> Iteration 298: 1.80e-03, 5.07e-08
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/results_in_progress/volume_iter_0300.h5
Saving volume to h5 file: ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/volume.h5
Saved the final volume estimation to ../reconstructions/Voxels/2025-04-29_19-49-14_VoxRingXZIt300Reg50Lr4/volume.h5
