
Initializing a Reconstructor, using computing device cpu
Omitting rays based on pixels with zero retardance.
For raytracing, using computing device cpu
Raytracing time in seconds: 11.39
Preparing rays for all rays at once...
Prepared geometry for all rays at once.
No radiometry provided for filtering rays.
Saving rays...
Rays saved in 1 seconds to ../reconstructions/Spicule/2025-04-26_21-32-29_/config_parameters/rays.pkl
Setting up the voxel mask...
Identifying the voxels that are reached by the rays out of the 650547 voxels.
Number of voxels reached by the rays: 588,831
	Included in nonzero retardance pixels: 588,712
	Included in zero retardance pixels: 583,018
		For 5 or more rays: 555,188
Masking out voxels except for 33532 voxels. First, at most, 20 voxels are tensor([ 4,  5,  6,  7,  8,  9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22,
        23, 24], dtype=torch.int32)
Voxel mask created in 18.59 seconds
Using retardance and azimuth images for data-fidelity term.
Reconstructor initialized in 49.01 seconds

Deleting unnecessary attributes to save memory...
	Deleted nonzero pixels dict
	Deleted ray valid indices by ray num
	Deleted mask from rays class
	Deleted radiometry
	Deleted volume initial guess
Beginning reconstruction...
Setting up optimizer and scheduler...
Using optimizer: Nadam
Using optimizer: Nadam
Starting iterations...
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0010.h5
Learning rates changed at iteration 11:
Iteration 10: 1.00e-01, 1.00e-04 -> Iteration 11: 5.01e-02, 1.00e-04
Learning rates changed at iteration 12:
Iteration 11: 5.01e-02, 1.00e-04 -> Iteration 12: 4.22e-02, 1.00e-04
Learning rates changed at iteration 13:
Iteration 12: 4.22e-02, 1.00e-04 -> Iteration 13: 3.46e-02, 1.00e-04
Learning rates changed at iteration 14:
Iteration 13: 3.46e-02, 1.00e-04 -> Iteration 14: 2.74e-02, 1.00e-04
Learning rates changed at iteration 15:
Iteration 14: 2.74e-02, 1.00e-04 -> Iteration 15: 2.07e-02, 1.00e-04
Learning rates changed at iteration 16:
Iteration 15: 2.07e-02, 1.00e-04 -> Iteration 16: 1.47e-02, 1.00e-04
Learning rates changed at iteration 17:
Iteration 16: 1.47e-02, 1.00e-04 -> Iteration 17: 9.64e-03, 1.00e-04
Learning rates changed at iteration 18:
Iteration 17: 9.64e-03, 1.00e-04 -> Iteration 18: 5.54e-03, 1.00e-04
Learning rates changed at iteration 19:
Iteration 18: 5.54e-03, 1.00e-04 -> Iteration 19: 2.54e-03, 1.00e-04
Learning rates changed at iteration 20:
Iteration 19: 2.54e-03, 1.00e-04 -> Iteration 20: 7.15e-04, 1.00e-04
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0020.h5
Learning rates changed at iteration 21:
Iteration 20: 7.15e-04, 1.00e-04 -> Iteration 21: 1.00e-01, 1.00e-04
Learning rates changed at iteration 22:
Iteration 21: 1.00e-01, 1.00e-04 -> Iteration 22: 9.98e-02, 1.00e-04
Learning rates changed at iteration 23:
Iteration 22: 9.98e-02, 1.00e-04 -> Iteration 23: 9.94e-02, 1.00e-04
Learning rates changed at iteration 24:
Iteration 23: 9.94e-02, 1.00e-04 -> Iteration 24: 9.86e-02, 1.00e-04
Learning rates changed at iteration 25:
Iteration 24: 9.86e-02, 1.00e-04 -> Iteration 25: 9.76e-02, 1.00e-04
Learning rates changed at iteration 26:
Iteration 25: 9.76e-02, 1.00e-04 -> Iteration 26: 9.62e-02, 1.00e-04
Learning rates changed at iteration 27:
Iteration 26: 9.62e-02, 1.00e-04 -> Iteration 27: 9.46e-02, 1.00e-04
Learning rates changed at iteration 28:
Iteration 27: 9.46e-02, 1.00e-04 -> Iteration 28: 9.26e-02, 1.00e-04
Learning rates changed at iteration 29:
Iteration 28: 9.26e-02, 1.00e-04 -> Iteration 29: 9.05e-02, 1.00e-04
Learning rates changed at iteration 30:
Iteration 29: 9.05e-02, 1.00e-04 -> Iteration 30: 8.80e-02, 1.00e-04
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0030.h5
Learning rates changed at iteration 31:
Iteration 30: 8.80e-02, 1.00e-04 -> Iteration 31: 8.54e-02, 8.00e-05
Learning rates changed at iteration 32:
Iteration 31: 8.54e-02, 8.00e-05 -> Iteration 32: 8.25e-02, 8.00e-05
Learning rates changed at iteration 33:
Iteration 32: 8.25e-02, 8.00e-05 -> Iteration 33: 7.94e-02, 8.00e-05
Learning rates changed at iteration 34:
Iteration 33: 7.94e-02, 8.00e-05 -> Iteration 34: 7.61e-02, 8.00e-05
Learning rates changed at iteration 35:
Iteration 34: 7.61e-02, 8.00e-05 -> Iteration 35: 7.27e-02, 8.00e-05
Learning rates changed at iteration 36:
Iteration 35: 7.27e-02, 8.00e-05 -> Iteration 36: 6.92e-02, 8.00e-05
Learning rates changed at iteration 37:
Iteration 36: 6.92e-02, 8.00e-05 -> Iteration 37: 6.55e-02, 8.00e-05
Learning rates changed at iteration 38:
Iteration 37: 6.55e-02, 8.00e-05 -> Iteration 38: 6.17e-02, 8.00e-05
Learning rates changed at iteration 39:
Iteration 38: 6.17e-02, 8.00e-05 -> Iteration 39: 5.79e-02, 8.00e-05
Learning rates changed at iteration 40:
Iteration 39: 5.79e-02, 8.00e-05 -> Iteration 40: 5.40e-02, 8.00e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0040.h5
Learning rates changed at iteration 41:
Iteration 40: 5.40e-02, 8.00e-05 -> Iteration 41: 5.01e-02, 8.00e-05
Learning rates changed at iteration 42:
Iteration 41: 5.01e-02, 8.00e-05 -> Iteration 42: 4.61e-02, 8.00e-05
Learning rates changed at iteration 43:
Iteration 42: 4.61e-02, 8.00e-05 -> Iteration 43: 4.22e-02, 8.00e-05
Learning rates changed at iteration 44:
Iteration 43: 4.22e-02, 8.00e-05 -> Iteration 44: 3.84e-02, 8.00e-05
Learning rates changed at iteration 45:
Iteration 44: 3.84e-02, 8.00e-05 -> Iteration 45: 3.46e-02, 8.00e-05
Learning rates changed at iteration 46:
Iteration 45: 3.46e-02, 8.00e-05 -> Iteration 46: 3.09e-02, 8.00e-05
Learning rates changed at iteration 47:
Iteration 46: 3.09e-02, 8.00e-05 -> Iteration 47: 2.74e-02, 8.00e-05
Learning rates changed at iteration 48:
Iteration 47: 2.74e-02, 8.00e-05 -> Iteration 48: 2.40e-02, 8.00e-05
Learning rates changed at iteration 49:
Iteration 48: 2.40e-02, 8.00e-05 -> Iteration 49: 2.07e-02, 8.00e-05
Learning rates changed at iteration 50:
Iteration 49: 2.07e-02, 8.00e-05 -> Iteration 50: 1.76e-02, 8.00e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0050.h5
Learning rates changed at iteration 51:
Iteration 50: 1.76e-02, 8.00e-05 -> Iteration 51: 1.47e-02, 8.00e-05
Learning rates changed at iteration 52:
Iteration 51: 1.47e-02, 8.00e-05 -> Iteration 52: 1.21e-02, 8.00e-05
Learning rates changed at iteration 53:
Iteration 52: 1.21e-02, 8.00e-05 -> Iteration 53: 9.64e-03, 8.00e-05
Learning rates changed at iteration 54:
Iteration 53: 9.64e-03, 8.00e-05 -> Iteration 54: 7.46e-03, 8.00e-05
Learning rates changed at iteration 55:
Iteration 54: 7.46e-03, 8.00e-05 -> Iteration 55: 5.54e-03, 8.00e-05
Learning rates changed at iteration 56:
Iteration 55: 5.54e-03, 8.00e-05 -> Iteration 56: 3.90e-03, 8.00e-05
Learning rates changed at iteration 57:
Iteration 56: 3.90e-03, 8.00e-05 -> Iteration 57: 2.54e-03, 8.00e-05
Learning rates changed at iteration 58:
Iteration 57: 2.54e-03, 8.00e-05 -> Iteration 58: 1.48e-03, 8.00e-05
Learning rates changed at iteration 59:
Iteration 58: 1.48e-03, 8.00e-05 -> Iteration 59: 7.15e-04, 8.00e-05
Learning rates changed at iteration 60:
Iteration 59: 7.15e-04, 8.00e-05 -> Iteration 60: 2.54e-04, 8.00e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0060.h5
Learning rates changed at iteration 61:
Iteration 60: 2.54e-04, 8.00e-05 -> Iteration 61: 1.00e-01, 8.00e-05
Learning rates changed at iteration 62:
Iteration 61: 1.00e-01, 8.00e-05 -> Iteration 62: 1.00e-01, 8.00e-05
Learning rates changed at iteration 63:
Iteration 62: 1.00e-01, 8.00e-05 -> Iteration 63: 9.98e-02, 8.00e-05
Learning rates changed at iteration 64:
Iteration 63: 9.98e-02, 8.00e-05 -> Iteration 64: 9.97e-02, 8.00e-05
Learning rates changed at iteration 65:
Iteration 64: 9.97e-02, 8.00e-05 -> Iteration 65: 9.94e-02, 8.00e-05
Learning rates changed at iteration 66:
Iteration 65: 9.94e-02, 8.00e-05 -> Iteration 66: 9.90e-02, 8.00e-05
Learning rates changed at iteration 67:
Iteration 66: 9.90e-02, 8.00e-05 -> Iteration 67: 9.86e-02, 8.00e-05
Learning rates changed at iteration 68:
Iteration 67: 9.86e-02, 8.00e-05 -> Iteration 68: 9.81e-02, 8.00e-05
Learning rates changed at iteration 69:
Iteration 68: 9.81e-02, 8.00e-05 -> Iteration 69: 9.76e-02, 8.00e-05
Learning rates changed at iteration 70:
Iteration 69: 9.76e-02, 8.00e-05 -> Iteration 70: 9.69e-02, 8.00e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0070.h5
Learning rates changed at iteration 71:
Iteration 70: 9.69e-02, 8.00e-05 -> Iteration 71: 9.62e-02, 6.40e-05
Learning rates changed at iteration 72:
Iteration 71: 9.62e-02, 6.40e-05 -> Iteration 72: 9.54e-02, 6.40e-05
Learning rates changed at iteration 73:
Iteration 72: 9.54e-02, 6.40e-05 -> Iteration 73: 9.46e-02, 6.40e-05
Learning rates changed at iteration 74:
Iteration 73: 9.46e-02, 6.40e-05 -> Iteration 74: 9.36e-02, 6.40e-05
Learning rates changed at iteration 75:
Iteration 74: 9.36e-02, 6.40e-05 -> Iteration 75: 9.26e-02, 6.40e-05
Learning rates changed at iteration 76:
Iteration 75: 9.26e-02, 6.40e-05 -> Iteration 76: 9.16e-02, 6.40e-05
Learning rates changed at iteration 77:
Iteration 76: 9.16e-02, 6.40e-05 -> Iteration 77: 9.05e-02, 5.12e-05
Learning rates changed at iteration 78:
Iteration 77: 9.05e-02, 5.12e-05 -> Iteration 78: 8.93e-02, 5.12e-05
Learning rates changed at iteration 79:
Iteration 78: 8.93e-02, 5.12e-05 -> Iteration 79: 8.80e-02, 5.12e-05
Learning rates changed at iteration 80:
Iteration 79: 8.80e-02, 5.12e-05 -> Iteration 80: 8.67e-02, 5.12e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0080.h5
Learning rates changed at iteration 81:
Iteration 80: 8.67e-02, 5.12e-05 -> Iteration 81: 8.54e-02, 5.12e-05
Learning rates changed at iteration 82:
Iteration 81: 8.54e-02, 5.12e-05 -> Iteration 82: 8.40e-02, 5.12e-05
Learning rates changed at iteration 83:
Iteration 82: 8.40e-02, 5.12e-05 -> Iteration 83: 8.25e-02, 5.12e-05
Learning rates changed at iteration 84:
Iteration 83: 8.25e-02, 5.12e-05 -> Iteration 84: 8.10e-02, 5.12e-05
Learning rates changed at iteration 85:
Iteration 84: 8.10e-02, 5.12e-05 -> Iteration 85: 7.94e-02, 5.12e-05
Learning rates changed at iteration 86:
Iteration 85: 7.94e-02, 5.12e-05 -> Iteration 86: 7.78e-02, 5.12e-05
Learning rates changed at iteration 87:
Iteration 86: 7.78e-02, 5.12e-05 -> Iteration 87: 7.61e-02, 5.12e-05
Learning rates changed at iteration 88:
Iteration 87: 7.61e-02, 5.12e-05 -> Iteration 88: 7.45e-02, 5.12e-05
Learning rates changed at iteration 89:
Iteration 88: 7.45e-02, 5.12e-05 -> Iteration 89: 7.27e-02, 5.12e-05
Learning rates changed at iteration 90:
Iteration 89: 7.27e-02, 5.12e-05 -> Iteration 90: 7.10e-02, 5.12e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0090.h5
Learning rates changed at iteration 91:
Iteration 90: 7.10e-02, 5.12e-05 -> Iteration 91: 6.92e-02, 5.12e-05
Learning rates changed at iteration 92:
Iteration 91: 6.92e-02, 5.12e-05 -> Iteration 92: 6.73e-02, 5.12e-05
Learning rates changed at iteration 93:
Iteration 92: 6.73e-02, 5.12e-05 -> Iteration 93: 6.55e-02, 5.12e-05
Learning rates changed at iteration 94:
Iteration 93: 6.55e-02, 5.12e-05 -> Iteration 94: 6.36e-02, 5.12e-05
Learning rates changed at iteration 95:
Iteration 94: 6.36e-02, 5.12e-05 -> Iteration 95: 6.17e-02, 5.12e-05
Learning rates changed at iteration 96:
Iteration 95: 6.17e-02, 5.12e-05 -> Iteration 96: 5.98e-02, 5.12e-05
Learning rates changed at iteration 97:
Iteration 96: 5.98e-02, 5.12e-05 -> Iteration 97: 5.79e-02, 5.12e-05
Learning rates changed at iteration 98:
Iteration 97: 5.79e-02, 5.12e-05 -> Iteration 98: 5.59e-02, 5.12e-05
Learning rates changed at iteration 99:
Iteration 98: 5.59e-02, 5.12e-05 -> Iteration 99: 5.40e-02, 5.12e-05
Learning rates changed at iteration 100:
Iteration 99: 5.40e-02, 5.12e-05 -> Iteration 100: 5.20e-02, 5.12e-05
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/results_in_progress/volume_iter_0100.h5
Saving volume to h5 file: ../reconstructions/Spicule/2025-04-26_21-32-29_/volume.h5
Saved the final volume estimation to ../reconstructions/Spicule/2025-04-26_21-32-29_/volume.h5
